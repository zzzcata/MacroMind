<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MacroMind</title>

<style>
* { box-sizing: border-box; }

body {
  margin:0;
  font-family: Inter, system-ui, Arial;
  background: radial-gradient(circle at 20% 20%, #0a0f1c, #05070d);
  color:#e6edf3;
  display:flex;
  justify-content:center;
}

.container {
  width:820px;
  padding-top:80px;
}

h1 {
  font-size:42px;
  margin:0;
  font-weight:600;
  letter-spacing:-0.5px;
  background: linear-gradient(90deg,#58a6ff,#7ee787);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.subtitle {
  color:#8b949e;
  margin-top:6px;
  margin-bottom:40px;
  font-size:15px;
}

.search {
  display:flex;
  gap:12px;
  margin-bottom:40px;
}

input {
  flex:1;
  padding:16px;
  font-size:18px;
  background:#0d1117;
  border:1px solid #30363d;
  color:white;
  border-radius:12px;
  outline:none;
}

input:focus {
  border-color:#58a6ff;
  box-shadow:0 0 0 1px #58a6ff;
}

button {
  padding:16px 26px;
  font-size:16px;
  background:linear-gradient(90deg,#238636,#2ea043);
  color:white;
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-weight:600;
  transition:0.2s;
}

button:hover {
  transform:translateY(-1px);
  box-shadow:0 6px 20px rgba(46,160,67,0.3);
}

.card {
  background:rgba(13,17,23,0.7);
  backdrop-filter:blur(14px);
  border:1px solid rgba(88,166,255,0.15);
  padding:26px;
  margin-top:26px;
  border-radius:16px;
  box-shadow:0 10px 40px rgba(0,0,0,0.4);
}

.summary {
  font-size:16px;
  line-height:1.65;
  color:#d6e2f0;
}

.tickerline {
  font-size:20px;
  margin-bottom:10px;
}

.confidence {
  display:inline-block;
  margin-left:10px;
  padding:5px 12px;
  border-radius:20px;
  font-size:12px;
  background:rgba(240,180,41,0.15);
  color:#f0b429;
}

.label {
  color:#58a6ff;
  font-weight:600;
  margin-bottom:12px;
}

.driver {
  padding:14px;
  border-radius:10px;
  margin-bottom:10px;
  background:rgba(88,166,255,0.06);
  border:1px solid rgba(88,166,255,0.15);
}

.system {
  font-size:13px;
  color:#8b949e;
  line-height:1.7;
}

.loading {
  color:#8b949e;
  margin-top:10px;
}

.error {
  color:#ff7b72;
  margin-top:10px;
  font-weight:500;
}

.footer {
  text-align:center;
  margin-top:50px;
  color:#6e7681;
  font-size:12px;
}
</style>
</head>

<body>

<div class="container">

<h1>MacroMind</h1>
<div class="subtitle">AI-native market intelligence engine</div>

<div class="search">
  <input id="ticker" placeholder="Enter ticker (AAPL, NVDA…)" />
  <button onclick="analyze()">Analyze</button>
</div>

<div id="status"></div>
<div id="result"></div>

<div class="footer">
Hybrid intelligence · AI + deterministic reasoning
</div>

</div>

<script>

// ENTER key support
document.getElementById("ticker").addEventListener("keydown", function(e){
  if(e.key === "Enter"){
    analyze();
  }
});

async function analyze() {
  const ticker = document.getElementById("ticker").value.trim().toUpperCase();
  const resultDiv = document.getElementById("result");
  const statusDiv = document.getElementById("status");

  resultDiv.innerHTML = "";
  statusDiv.innerHTML = "";

  if (!ticker) {
    statusDiv.innerHTML = '<div class="error">Enter a ticker</div>';
    return;
  }

  statusDiv.innerHTML = '<div class="loading">Running market intelligence...</div>';

  try {
    const res = await fetch(`https://macromind-api-3edn.onrender.com/analyze?ticker=${ticker}`);
    const data = await res.json();

    if (data.error) {
      statusDiv.innerHTML = `<div class="error">${data.message}</div>`;
      return;
    }

    statusDiv.innerHTML = "";

    const i = data.interpretation;

    const priceFormatted = new Intl.NumberFormat("en-US", {
      style: "currency",
      currency: "USD"
    }).format(data.facts.price);

    let html = `
      <div class="card">
        <div class="tickerline">
          <b>${data.request.ticker}</b> — ${priceFormatted} 
          (${data.facts.pct_change_1d.toFixed(2)}%)
          <span class="confidence">${i.confidence.level} confidence</span>
        </div>

        <div class="summary">${i.summary}</div>
      </div>

      <div class="card">
        <div class="label">Drivers</div>
    `;

    i.drivers.forEach(d=>{
      html += `
        <div class="driver">
          <b>${d.label}</b> (${d.type}) — strength: ${d.strength}
        </div>
      `;
    });

    html += `
      </div>

      <div class="card system">
        <div class="label">System</div>
        Model: ${data.meta.model}<br>
        Architecture: Hybrid AI + rule engine<br>
        Sources: Finnhub market data + news
      </div>
    `;

    resultDiv.innerHTML = html;

  } catch (err) {
    statusDiv.innerHTML = '<div class="error">API connection failed</div>';
  }
}
</script>

</body>
</html>
